@model IEnumerable<PostViewModel>
@{
    ViewBag.Title = "Index";
}

<div class="card">
    <div class="card-header">
        <h2 class="card-title">All Post</h2>
        <div class="card-tools">
            <a href="@Url.Action("ManageQuotes","Quotes")" class="btn btn-sm btn-primary"> Add New</a>
        </div>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table id="tblPosts" class="table table-striped table-bordered table-hover table-sm">
                <thead>
                    <tr>
                        <th>Image</th>
                        <th>Text</th>
                        <th>Tags</th>
                        <th>Category</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>
</div>
@section scripts{
    <script type="text/javascript">
        $(document).ready(function () {
            getPost();
        });

        $(document).on("click", ".post-delete", function () {
            var postID = $(this).data("id");
            deleteRecord(function (result) {
                if (result) {
                    $.ajax({
                        url: "/Quotes/DeletePostByPostID?PostId=" + postID,
                        type: 'Get',
                        data: postID,
                        success: function (result) {
                            if (result.result.isSuccess) {
                                Toastr("success", result.result.message);
                                oTable.ajax.reload();
                            }
                        }
                    });
                }
            });
        });

        var oTable;
        function getPost() {
            oTable = $("#tblPosts").DataTable({
                "bServerSide": true,
                "bSearchable": true,
                "bPaginate": true,
                "order": [[1, 'asc']],
                "language": {
                    "emptyTable": "No record found.",
                    "processing":
                        '<i class="fa fa-spinner fa-spin fa-3x fa-fw" style="color:#2a2b2b;"></i><span class="sr-only">Loading...</span> '
                },
                "sAjaxSource": "/Quotes/GetUserPost",

                "columns": [
                    {
                        "data": "imageName",
                        "render": function (data, type, full, meta) {
                            return '<img style="height:100px;width:100px" src="/Assets/Image/QuotesData/'+data+'">'
                        }
                    },
                    { "data": "quoteText" },
                    { "data": "tags" },
                    { "data": "postCategory" },
                    {
                        "data": "postID",
                        "render": function (data, type, full, meta) {
                                return '<a data-id='+data+' class="btn btn-sm btn-danger post-delete">Delete</a>'
                        }
                    },
                ]
            });
        }

    </script>
}